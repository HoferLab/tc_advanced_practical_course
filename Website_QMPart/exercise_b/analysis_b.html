<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analysis B – PR Theoretical Chemistry and Computer-Chemistry (Advanced)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../exercise_b/howto_b.html" rel="next">
<link href="../exercise_b/exercise_b.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../custom.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../exercise_b/exercise_b.html">Excercise B - NNP Molecular Dynamics</a></li><li class="breadcrumb-item"><a href="../exercise_b/analysis_b.html"><span class="chapter-title">Analysis B</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">PR Theoretical Chemistry and Computer-Chemistry (Advanced)</a> 
        <div class="sidebar-tools-main tools-wide">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-substack"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="../presentation/analysis_b_presentation.html">
            Analysis B Presentation
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="../presentation/howto_b_presentation.html">
            HowTo B Presentation
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-table"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://docs.google.com/spreadsheets/d/1wLiVdocFKj4iYNReIv2KdyEh5-HF7x3P1qJy946fHts/edit?usp=sharing">
            Thermal Expansion
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://docs.google.com/spreadsheets/d/1k56gQvhw8spThA9WNhdUirlWV9gKY-G1va8DjMysdBU/edit?usp=sharing">
            Gas Diffusion
            </a>
          </li>
      </ul>
    </div>
    <a href="../PR-Theoretical-Chemistry-and-Computer-Chemistry--Advanced-.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Instructions</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Excercise A - Vibration Spectroscopy</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercise_a/background_info_a.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Background Info A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercise_a/exercise_a.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">HowTo A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercise_a/checklist_a.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Checklist A</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Excercise B - NNP Molecular Dynamics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercise_b/exercise_b.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Background Info B</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercise_b/analysis_b.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Analysis B</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercise_b/howto_b.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">HowTo B</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercise_b/checklist_b.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Checklist B</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Templates</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../templates/matplotlib.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Matplotlib</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../templates/poster.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Poster Templates</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Guides</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../guides/statistics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Statistical Excursion</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../guides/linux_quickstart_guide.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Linux Quickstart Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../guides/scientific_plot_quickstart.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Visualization Quickstart Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../guides/latex_quickstart.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Latex Quickstart Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../guides/python_quickstart.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Python Quickstart Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../guides/VisualizationPythonPackages.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Python Modules for Data Visualization</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#preanalysis" id="toc-preanalysis" class="nav-link active" data-scroll-target="#preanalysis">Preanalysis</a>
  <ul class="collapse">
  <li><a href="#log-file-check" id="toc-log-file-check" class="nav-link" data-scroll-target="#log-file-check">Log-file check</a></li>
  <li><a href="#visual-inspection" id="toc-visual-inspection" class="nav-link" data-scroll-target="#visual-inspection">Visual inspection</a></li>
  <li><a href="#troubleshooting" id="toc-troubleshooting" class="nav-link" data-scroll-target="#troubleshooting">Troubleshooting</a></li>
  </ul></li>
  <li><a href="#equilibrium-state-of-simulation" id="toc-equilibrium-state-of-simulation" class="nav-link" data-scroll-target="#equilibrium-state-of-simulation">Equilibrium state of simulation</a>
  <ul class="collapse">
  <li><a href="#arithmetic-average-standard-deviation-and-standard-error" id="toc-arithmetic-average-standard-deviation-and-standard-error" class="nav-link" data-scroll-target="#arithmetic-average-standard-deviation-and-standard-error">Arithmetic Average, Standard Deviation and Standard Error</a></li>
  <li><a href="#running-average" id="toc-running-average" class="nav-link" data-scroll-target="#running-average">Running Average</a></li>
  <li><a href="#cummulative-average" id="toc-cummulative-average" class="nav-link" data-scroll-target="#cummulative-average">Cummulative Average</a></li>
  <li><a href="#linear-regression-fit" id="toc-linear-regression-fit" class="nav-link" data-scroll-target="#linear-regression-fit">Linear Regression Fit</a></li>
  <li><a href="#plot-of-temperature-over-simulation-time" id="toc-plot-of-temperature-over-simulation-time" class="nav-link" data-scroll-target="#plot-of-temperature-over-simulation-time">Plot of temperature over simulation time</a></li>
  </ul></li>
  <li><a href="#linear-volumetric-thermal-expansion-coefficient" id="toc-linear-volumetric-thermal-expansion-coefficient" class="nav-link" data-scroll-target="#linear-volumetric-thermal-expansion-coefficient">Linear / Volumetric Thermal Expansion Coefficient</a>
  <ul class="collapse">
  <li><a href="#plot-lattice-parameter-vs.-temperature" id="toc-plot-lattice-parameter-vs.-temperature" class="nav-link" data-scroll-target="#plot-lattice-parameter-vs.-temperature">Plot Lattice Parameter vs.&nbsp;Temperature</a></li>
  </ul></li>
  <li><a href="#interaction-energy" id="toc-interaction-energy" class="nav-link" data-scroll-target="#interaction-energy">Interaction Energy</a></li>
  <li><a href="#radial-distribution-functions-rdfs" id="toc-radial-distribution-functions-rdfs" class="nav-link" data-scroll-target="#radial-distribution-functions-rdfs">Radial Distribution Functions (RDFs)</a></li>
  <li><a href="#self-diffusion-coefficient" id="toc-self-diffusion-coefficient" class="nav-link" data-scroll-target="#self-diffusion-coefficient">Self-Diffusion Coefficient</a>
  <ul class="collapse">
  <li><a href="#einstein-relation" id="toc-einstein-relation" class="nav-link" data-scroll-target="#einstein-relation">Einstein-Relation</a>
  <ul class="collapse">
  <li><a href="#mean-squared-displacement" id="toc-mean-squared-displacement" class="nav-link" data-scroll-target="#mean-squared-displacement">Mean-Squared Displacement</a></li>
  </ul></li>
  <li><a href="#green-kubo-relation" id="toc-green-kubo-relation" class="nav-link" data-scroll-target="#green-kubo-relation">Green-Kubo Relation</a>
  <ul class="collapse">
  <li><a href="#veloctiy-autocorrelation-function" id="toc-veloctiy-autocorrelation-function" class="nav-link" data-scroll-target="#veloctiy-autocorrelation-function">Veloctiy-Autocorrelation Function</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#activation-energy" id="toc-activation-energy" class="nav-link" data-scroll-target="#activation-energy">Activation Energy</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../exercise_b/exercise_b.html">Excercise B - NNP Molecular Dynamics</a></li><li class="breadcrumb-item"><a href="../exercise_b/analysis_b.html"><span class="chapter-title">Analysis B</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Analysis B</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="preanalysis" class="level1 unnumbered">
<h1 class="unnumbered">Preanalysis</h1>
<section id="log-file-check" class="level2">
<h2 class="anchored" data-anchor-id="log-file-check">Log-file check</h2>
<p>Open the <code>*.log</code> file with any editor.</p>
<p>Check if the log file end with this:</p>
<ul class="task-list">
<li><label><input type="checkbox">“PQ ended normally”</label></li>
</ul>
<p>You can also grep for this statement to verify the normal termination of the simulation for all files:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource {bash} number-lines code-with-copy"><code class="sourceCode"><span id="cb1-1"><a href="#cb1-1"></a>grep "PQ ended" *.log</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="visual-inspection" class="level2">
<h2 class="anchored" data-anchor-id="visual-inspection">Visual inspection</h2>
<p>Check if the system is behaving like expected.</p>
<p>Open the <code>*.xyz</code> file with <code>VMD</code>.</p>
<p>It is a good sign if</p>
<ul class="task-list">
<li><p><label><input type="checkbox">no atom has been shoot out of the box</label></p></li>
<li><p><label><input type="checkbox">box was not collapsing or blowing up</label></p></li>
<li><p><label><input type="checkbox">no unexpected movements was happening</label></p></li>
</ul>
<p>ect.</p>
</section>
<section id="troubleshooting" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="troubleshooting">Troubleshooting</h2>
<p>If the simulation is not computed as expected some first-aid steps can be done:</p>
<ul class="task-list">
<li><p><label><input type="checkbox">Try to understanding any error messages that may have arisen</label></p></li>
<li><p><label><input type="checkbox">Check in the <code>*.log</code> file and <code>*.in</code> if the simulation was setup correctly.</label></p></li>
<li><p><label><input type="checkbox">Check the starting structure</label></p></li>
<li><p><label><input type="checkbox">Check the moldescriptor</label></p></li>
</ul>
<p>ect.</p>
</section>
</section>
<section id="equilibrium-state-of-simulation" class="level1 unnumbered">
<h1 class="unnumbered">Equilibrium state of simulation</h1>
<p>Firstly, in order to obtain meaningful physical properties from a simulation, it is essential to ensure that the system is in an equilibrium state. However, what constitutes an <em>equilibrium state</em>?</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
An equilibrium state:
</div>
</div>
<div class="callout-body-container callout-body">
<p>can be defined as a state in which macroscopic properties <span class="math inline">\(A\)</span> (<em>e.g</em> temperture <span class="math inline">\(T\)</span>, pressure <span class="math inline">\(P\)</span>, energies <span class="math inline">\(E\)</span>, volume <span class="math inline">\(V\)</span>,…) do <strong>NOT</strong> undergo major changes over time.</p>
</div>
</div>
<p>Once these properties fluctuate around a constant pattern without any long-term trends, it can be assumed that the system reached an equilibrium state.</p>
<section id="arithmetic-average-standard-deviation-and-standard-error" class="level2">
<h2 class="anchored" data-anchor-id="arithmetic-average-standard-deviation-and-standard-error">Arithmetic Average, Standard Deviation and Standard Error</h2>
<p>The aforementioned constant relaxation of the properties can be verified by calculating the arithmetic mean of the properties <span class="math inline">\(\left &lt; A \right &gt;\)</span></p>
<p><span class="math display">\[
\left &lt; A \right &gt;  = \frac{1}{n}\sum_{i=0}^{n} a(t_{i})
\]</span> where <span class="math inline">\(a(t_{i})\)</span> is the property <span class="math inline">\(a\)</span> at time step <span class="math inline">\(t_i\)</span> and <span class="math inline">\(n\)</span> the total sampling time</p>
<p>as well as the standard deviation <span class="math inline">\(A_{\sigma }\)</span></p>
<p><span class="math display">\[
A_{\sigma }= \sqrt{ \frac{1}{n}\sum_{i=0}^{n} (a(t_{i}) - \left &lt; A \right &gt; )^2}.
\]</span> and standard error <span class="math inline">\(A_{\nu}\)</span> of the arithmetic average <span class="math display">\[
A_{\nu} = \frac{A_{\sigma }}{\sqrt{n}}
\]</span></p>
</section>
<section id="running-average" class="level2">
<h2 class="anchored" data-anchor-id="running-average">Running Average</h2>
<p>Further the running average <span class="math inline">\(\left &lt; A \right &gt;_{\tau}\)</span> at time <span class="math inline">\(\tau\)</span> with a window size of <span class="math inline">\(\omega\)</span> and a gap size <span class="math inline">\(g\)</span></p>
<p><span class="math display">\[
\left &lt; A \right &gt;_{\tau} = \frac{1}{\omega}\sum_{i=\tau-(\omega-1)g}^{\tau} a(t_{i})
\]</span> <em>e.g.</em> <span class="math inline">\(\tau=5\)</span>, <span class="math inline">\(\omega=3\)</span>, <span class="math inline">\(g=2\)</span> <span class="math display">\[
\left &lt; A \right &gt;_{5} = \frac{1}{3} (a(t_{1})+a(t_{3})+a(t_{5}))
\]</span></p>
<p>can help to estimate the fluctuation of the properties over time.</p>
</section>
<section id="cummulative-average" class="level2">
<h2 class="anchored" data-anchor-id="cummulative-average">Cummulative Average</h2>
<p>And the cumulative average is a running average that is added at each step. <span class="math display">\[
\left &lt; A \right &gt;_n = \frac{(n-1)\left &lt; A \right &gt;_{n-1} + \left &lt; A \right &gt;_n}{n}
\]</span></p>
</section>
<section id="linear-regression-fit" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-fit">Linear Regression Fit</h2>
<p>Further linear regression fit helps to estimate the trend of your simulation.</p>
<p>For more further detail: <a href="../guides/statistics.html">statistics</a></p>
</section>
<section id="plot-of-temperature-over-simulation-time" class="level2">
<h2 class="anchored" data-anchor-id="plot-of-temperature-over-simulation-time">Plot of temperature over simulation time</h2>
<div id="cell-fig-temp" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="im">from</span> scipy.stats <span class="im">import</span> linregress</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a>mpl.rcParams[<span class="st">"font.size"</span>] <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>mpl.rcParams[<span class="st">"axes.labelsize"</span>] <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a>physical_properties <span class="op">=</span> [<span class="st">"SIMULATION-TIME"</span>, <span class="st">"TEMPERATURE"</span>, <span class="st">"PRESSURE"</span>, <span class="st">"E(TOT)"</span>, <span class="st">"E(QM)"</span>, <span class="st">"N(QM-ATOMS)"</span>, <span class="st">"E(KIN)"</span>, <span class="st">"E(INTRA)"</span>,<span class="st">"VOLUME"</span>,<span class="st">"DENSITY"</span>,<span class="st">"MOMENTUM"</span>,<span class="st">"LOOPTIME"</span>]</span>
<span id="cb2-12"><a href="#cb2-12"></a>physical_units <span class="op">=</span> [<span class="st">"fs"</span>, <span class="st">"K"</span>,<span class="st">"bar"</span>, <span class="st">"kcal/mol"</span>, <span class="st">"kcal/mol"</span>, <span class="st">"-"</span>,<span class="st">"kcal/mol"</span>,<span class="st">"kcal/mol"</span>,<span class="st">"A^3"</span>, <span class="st">"g/cm^3"</span>, <span class="st">"amuA/fs"</span>, <span class="st">"s"</span>]</span>
<span id="cb2-13"><a href="#cb2-13"></a>data <span class="op">=</span> pd.read_csv(<span class="st">"../data/physical_properties.en"</span>,sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">+'</span>,names<span class="op">=</span>physical_properties)</span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="bu">print</span>(data.head())</span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="bu">print</span>(<span class="st">"Shape of data: "</span>, data.shape)</span>
<span id="cb2-16"><a href="#cb2-16"></a>time <span class="op">=</span> data[<span class="st">"SIMULATION-TIME"</span>]<span class="op">/</span><span class="fl">1e6</span> <span class="co"># ns</span></span>
<span id="cb2-17"><a href="#cb2-17"></a>temperature_avg <span class="op">=</span> np.mean(data[<span class="st">"TEMPERATURE"</span>])</span>
<span id="cb2-18"><a href="#cb2-18"></a>temperature_std <span class="op">=</span> np.std(data[<span class="st">"TEMPERATURE"</span>])</span>
<span id="cb2-19"><a href="#cb2-19"></a>window <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb2-20"><a href="#cb2-20"></a>gap <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb2-21"><a href="#cb2-21"></a>running_average <span class="op">=</span> data[<span class="st">"TEMPERATURE"</span>].rolling(window<span class="op">=</span>window).mean() <span class="co">#window=window,min_periods=1,center=True,step=gap</span></span>
<span id="cb2-22"><a href="#cb2-22"></a></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="kw">def</span> linear_function(x,a,b):</span>
<span id="cb2-24"><a href="#cb2-24"></a>  <span class="cf">return</span> a<span class="op">*</span>x<span class="op">+</span>b</span>
<span id="cb2-25"><a href="#cb2-25"></a></span>
<span id="cb2-26"><a href="#cb2-26"></a></span>
<span id="cb2-27"><a href="#cb2-27"></a></span>
<span id="cb2-28"><a href="#cb2-28"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">4</span>))</span>
<span id="cb2-29"><a href="#cb2-29"></a>plt.plot(time,data[<span class="st">"TEMPERATURE"</span>],color<span class="op">=</span><span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>,label<span class="op">=</span><span class="vs">r"simulation"</span>)</span>
<span id="cb2-30"><a href="#cb2-30"></a>plt.plot(time,running_average,label<span class="op">=</span><span class="vs">r"$T_{\mathrm</span><span class="sc">{run.avg}</span><span class="vs">}$"</span>)</span>
<span id="cb2-31"><a href="#cb2-31"></a>plt.hlines(temperature_avg,xmin<span class="op">=</span>np.<span class="bu">min</span>(time),xmax<span class="op">=</span>np.<span class="bu">max</span>(time),linestyles<span class="op">=</span><span class="st">"solid"</span>,color<span class="op">=</span><span class="st">"black"</span>,label<span class="op">=</span><span class="vs">r"$T_{\mathrm</span><span class="sc">{avg}</span><span class="vs">}$"</span>)</span>
<span id="cb2-32"><a href="#cb2-32"></a>plt.hlines(temperature_avg<span class="op">+</span>temperature_std,xmin<span class="op">=</span>np.<span class="bu">min</span>(time),xmax<span class="op">=</span>np.<span class="bu">max</span>(time),linestyles<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">"black"</span>,label<span class="op">=</span><span class="vs">r"$T_{\mathrm</span><span class="sc">{std}</span><span class="vs">}$"</span>)</span>
<span id="cb2-33"><a href="#cb2-33"></a>plt.hlines(temperature_avg<span class="op">-</span>temperature_std,xmin<span class="op">=</span>np.<span class="bu">min</span>(time),xmax<span class="op">=</span>np.<span class="bu">max</span>(time),linestyles<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb2-34"><a href="#cb2-34"></a></span>
<span id="cb2-35"><a href="#cb2-35"></a>plt.xlabel(<span class="vs">r"$t$ / ns"</span>)</span>
<span id="cb2-36"><a href="#cb2-36"></a>plt.ylabel(<span class="vs">r"$T$ / K"</span>)</span>
<span id="cb2-37"><a href="#cb2-37"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb2-38"><a href="#cb2-38"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SIMULATION-TIME  TEMPERATURE      PRESSURE        E(TOT)         E(QM)  \
0          1656002   265.867307  -9219.140442 -39593.157062 -39779.394319   
1          1656004   232.575082 -10168.957588 -39594.249861 -39757.166264   
2          1656006   326.845099  -6236.688599 -39600.546646 -39829.498207   
3          1656008   398.202185   2882.459019 -39597.914972 -39876.851422   
4          1656010   382.115074   9870.653269 -39596.205739 -39863.873337   

   N(QM-ATOMS)      E(KIN)  E(INTRA)       VOLUME   DENSITY  MOMENTUM  \
0        276.0  186.237257       0.0  4946.281581  0.916867  0.000011   
1        276.0  162.916403       0.0  4944.425576  0.917211  0.000011   
2        276.0  228.951560       0.0  4943.049144  0.917466  0.000011   
3        276.0  278.936450       0.0  4943.121195  0.917453  0.000011   
4        276.0  267.667598       0.0  4944.683355  0.917163  0.000011   

   LOOPTIME  
0   5.08360  
1   1.58753  
2   3.05997  
3   0.18536  
4   0.17990  
Shape of data:  (50000, 12)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-temp" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-temp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="analysis_b_files/figure-html/fig-temp-output-2.png" width="710" height="376" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-temp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: Temperature vs Time plot
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="linear-volumetric-thermal-expansion-coefficient" class="level1 unnumbered">
<h1 class="unnumbered">Linear / Volumetric Thermal Expansion Coefficient</h1>
<p>Thermal expansion coefficient is a quantity that describes the extent to which a solid substance undergoes a change in response to variations in temperature.</p>
<p>Therefore the system is computed in <span class="math inline">\(NPT\)</span> ensemble at different temperatures <span class="math inline">\(T_i\)</span> <em>e.g.</em> <span class="math inline">\(i=\)</span>{248.15 K, 273.15 K, 298.15 K, 323.15 K, 348.15 K} at <span class="math inline">\(1\,\mathrm{bar}\)</span></p>
<ul>
<li><strong>Linear thermal expansion coefficient</strong></li>
</ul>
<p>Linear thermal expansion coefficient at <span class="math inline">\(\mathrm{298}\,\mathrm{K}\)</span> is calculated by the temperature <span class="math inline">\(T\)</span> gradient of the respective average lattice parameter <span class="math inline">\(\left &lt; a \right &gt;\)</span>, <span class="math inline">\(\left &lt; b \right &gt;\)</span> or <span class="math inline">\(\left &lt; c\right &gt;\)</span> at constant pressure <span class="math inline">\(P\)</span> (<span class="math inline">\(NPT\)</span> ensemble) <span class="math display">\[
\alpha _{x}^{T_{\mathrm{298\,K}}} = \frac{1}{x} \left ( \frac{\partial x}{\partial T} \right ) _{P}, x={a,b,c}
\]</span> The slope can be estimated numerically in different ways. A simple way is to employ a finite difference method. There are three fundamental types of it the <em>forward, backward</em> and <em>central</em> finite difference.</p>
<p>In our case we use the central finite difference method with <strong><a href="https://en.wikipedia.org/wiki/Five-point_stencil">five-point stencil</a></strong>. In general it is formulated in 1D as: <span class="math display">\[
f'(x) = \frac{-f(x+2h)+8f(x+h)-8f(x-h)+f(x-2h)}{12 h} + \frac{h^4}{30}f^{(5)(c)}, c \in [x-2h,x+2h]
\]</span> where <span class="math inline">\(h\)</span> is the change of <span class="math inline">\(x\)</span>.</p>
<p>If you use more than five points <a href="https://en.wikipedia.org/wiki/Finite_difference_coefficient">higher</a> stencil order can be used.</p>
<p>In our case the differentiation can be written as: <span class="math display">\[
\frac{\partial x}{\partial T} \approx \frac{ \left &lt; x^{T_{\mathrm{248\,K}}}\right &gt;-8 \left &lt; x^{T_{\mathrm{273\,K}}}\right &gt; + 8 \left &lt; x^{T_{\mathrm{323\,K}}}\right &gt; - \left &lt; x^{T_{\mathrm{348\,K}}} \right &gt; }{12\Delta T}
\]</span></p>
<ul>
<li><strong>Volumetric thermal expansion coefficient</strong> It is the same formulation like in the linear thermal expansion coefficient with the difference that the volume <span class="math inline">\(V\)</span> is used instead the individual lattice parameter: <span class="math display">\[
\alpha _{V}^{T_{\mathrm{298\,K}}} = \frac{1}{V} \left ( \frac{\partial V}{\partial T} \right ) _{P}
\]</span></li>
</ul>
<p>The volume of a cubic system can be calculated as: <span class="math display">\[
V = a\cdot b \cdot c
\]</span> In general of a non-orthorhombic <a href="https://en.wikipedia.org/wiki/Crystal_system">crystal sytems</a> the volume is calculatd by: <span class="math display">\[
V = a b c \sqrt{1-\mathrm{cos}^2(\alpha) -\mathrm{cos}^2(\beta) - \mathrm{cos}^2(\gamma)+ 2(\mathrm{cos}(\alpha) \mathrm{cos}(\beta) \mathrm{cos}(\gamma))}
\]</span></p>
<section id="plot-lattice-parameter-vs.-temperature" class="level2">
<h2 class="anchored" data-anchor-id="plot-lattice-parameter-vs.-temperature">Plot Lattice Parameter vs.&nbsp;Temperature</h2>
<div id="cell-fig-lattice" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a>mpl.rcParams[<span class="st">"font.size"</span>] <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>mpl.rcParams[<span class="st">"axes.labelsize"</span>] <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a>temperature <span class="op">=</span> np.array([<span class="fl">248.15</span>,<span class="fl">273.15</span>,<span class="fl">298.15</span>,<span class="fl">323.15</span>,<span class="fl">348.15</span>])</span>
<span id="cb4-10"><a href="#cb4-10"></a>a <span class="op">=</span> np.array([<span class="fl">25.8</span>, <span class="fl">25.77</span>, <span class="fl">25.73</span>, <span class="fl">25.70</span>, <span class="fl">25.66</span>])</span>
<span id="cb4-11"><a href="#cb4-11"></a>a_err <span class="op">=</span> np.array([<span class="fl">0.2</span>,<span class="fl">0.1</span>,<span class="fl">0.15</span>,<span class="fl">0.2</span>,<span class="fl">0.23</span>])</span>
<span id="cb4-12"><a href="#cb4-12"></a></span>
<span id="cb4-13"><a href="#cb4-13"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">4</span>))</span>
<span id="cb4-14"><a href="#cb4-14"></a>plt.errorbar(temperature,a,a_err,fmt<span class="op">=</span><span class="st">'ok'</span>,label<span class="op">=</span><span class="vs">r"$\left &lt; a \right &gt;$"</span>)</span>
<span id="cb4-15"><a href="#cb4-15"></a>plt.xlabel(<span class="vs">r"$T$ in K"</span>)</span>
<span id="cb4-16"><a href="#cb4-16"></a>plt.ylabel(<span class="vs">r"$\left &lt; a \right &gt; $ in $\mathrm{\AA}$"</span>)</span>
<span id="cb4-17"><a href="#cb4-17"></a>plt.xlim(<span class="dv">223</span>,<span class="dv">373</span>)</span>
<span id="cb4-18"><a href="#cb4-18"></a>plt.xticks(temperature)</span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co"># plt.legend(fontsize=12)</span></span>
<span id="cb4-20"><a href="#cb4-20"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-lattice" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lattice-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="analysis_b_files/figure-html/fig-lattice-output-1.png" width="704" height="376" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lattice-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: T vs a plot
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Experimental Measurement
</div>
</div>
<div class="callout-body-container callout-body">
<p>X-ray diffraction (XRD) powder X-ray diffraction (PXRD) neutron powder diffraction (NPD)</p>
</div>
</div>
</section>
</section>
<section id="interaction-energy" class="level1 unnumbered">
<h1 class="unnumbered">Interaction Energy</h1>
<p>The interaction energy is a measurement to estimate the energy share of interaction between the guest and host system. It can be calculated by substracting the single energy shares of the individual systems (<span class="math inline">\(U_{\mathrm{guest}}\)</span> and <span class="math inline">\(U_{\mathrm{host}}\)</span>) from the energy of the total system (<span class="math inline">\(U_{\mathrm{guest@host}}\)</span>): <span class="math display">\[
U_{\mathrm{int}} = \left&lt; U_{\mathrm{guest@host}} \right &gt; - \left&lt; U_{\mathrm{host}} \right &gt; -  \left&lt; U_{\mathrm{guest}} \right &gt;.
\]</span></p>
<p>In doing so you take the average total energy <span class="math inline">\(U=E_{\mathrm{kin}}+U_{\mathrm{pot}}\)</span> of the respective simulated systems (guest@host, host, guest) at a long enough equilibrated trajectory.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ensemble
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Pay attention:</em></p>
<p>The <span class="math inline">\(\left&lt; U_{\mathrm{guest@host}} \right&gt;\)</span> and <span class="math inline">\(\left&lt; U_{\mathrm{host}}\right &gt;\)</span> energy are determined by a <span class="math inline">\(NPT\)</span> simulation in contrast <span class="math inline">\(\left&lt; U_{\mathrm{guest}} \right &gt;\)</span> energy has to be calculated in a <span class="math inline">\(NVT\)</span> ensemble. A single gas molecule in a periodic box has to be calculated <span class="math inline">\(NVT\)</span> because <span class="math inline">\(NPT\)</span> would cause into crash of the simulation.</p>
</div>
</div>
</section>
<section id="radial-distribution-functions-rdfs" class="level1 unnumbered">
<h1 class="unnumbered">Radial Distribution Functions (RDFs)</h1>
<p>The radial distribution function (RDF) is a simple measurement to get structural information of the system.</p>
<p><img align="right" src="../img/rdf_sketch.png" width="313"></p>
<p>!RDF-plot</p>
<p>It describes the probability <span class="math inline">\(P_{ab}(r)\)</span> to find a target particle type <span class="math inline">\(b\)</span> at a distance <span class="math inline">\(r\)</span> away from a reference particle type <span class="math inline">\(a\)</span> <em>e.g.</em> the probability to find <span class="math inline">\(\mathrm{H}_2\)</span>from <span class="math inline">\(\mathrm{Zn}^{2+}\)</span> clusters in a distance <span class="math inline">\(r\)</span>: <span class="math display">\[
P_{ab}(r) = \int_{0}^{r'} 4\pi r'^2 g_{ab}(r') dr'
\]</span> where <span class="math inline">\(g_{ab}(r)\)</span> is the RDF. The RDF formulats the average local density <span class="math inline">\(\left &lt;\rho_{ab}(r)\right &gt;\)</span> normalized by <span class="math inline">\(\rho=(N_a N_b)\)</span> <span class="math display">\[
g(r) = \frac{\left &lt;\rho_{ab}(r)\right &gt;}{\rho}.
\]</span></p>
<p>The two-particle density correlation function is defined as:</p>
<p><span class="math display">\[
\rho_{ab}(r) =\sum_{i=1}^{N_a} \sum_{j=1}^{N_b} \left &lt; \delta(|\vec{r_{i}}-\vec{r_{j}}| -r)\right &gt;.
\]</span></p>
<p>The average number of particles <span class="math inline">\(b\)</span> that can be found in the shell of distance <span class="math inline">\(r\)</span> can be determined by multiplying the density <span class="math inline">\(\rho\)</span> with the probability <span class="math inline">\(G(r)\)</span> <span class="math display">\[
N_{ab}(r) = \rho G_{ab}(r)
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dirc-Delta Function
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
\delta(x-x_0) =  \begin{cases}
      0        &amp; x \neq x_0\\
      \infty &amp; x = x_0\\
    \end{cases}   
\]</span> <span class="math display">\[
\int_L \delta(x-x_0) dx = 1, x_0 \in L
\]</span></p>
</div>
</div>
</section>
<section id="self-diffusion-coefficient" class="level1 unnumbered">
<h1 class="unnumbered">Self-Diffusion Coefficient</h1>
<p>In order to describe the dynamic of guests in host systems, it is necessary to calculate transport properties. A transport property would be for example the <em>diffusion</em>, <em>viscosity</em>, <em>electrical or thermal conductivity</em>.</p>
<p>In general transport properties can be described as a property coefficient <span class="math inline">\(\gamma\)</span> which depends on microscopic variable <span class="math inline">\(A\)</span> (<em>e.g.</em> positions <span class="math inline">\(\Delta \vec{r}\)</span> or the velocities <span class="math inline">\(\vec{v}\)</span>) that is written as an infinite time integration of a non-normalized time correlation function <span class="math inline">\(\left &lt; \dot{A}(t)\dot{A}(t_0) \right &gt;\)</span> : <span class="math display">\[
\gamma = \int_{0}^{\infty} dt \left &lt; \dot{A}(t)\dot{A}(t_0) \right &gt;.
\]</span> This is also known as <strong>Green-Kubo</strong> relation<span class="citation" data-cites="Kubo1957"><sup><a href="#ref-Kubo1957" role="doc-biblioref">1</a></sup></span> which can also written as equivalent <strong>Einstein</strong> expression</p>
<p><span class="math display">\[
\gamma = \lim_{t\to\infty} \frac{\left &lt; (A(t) - A(t_0))^2 \right &gt;}{2t} = \frac{1}{2} \lim_{t\to\infty} \frac{d}{dt} \left &lt; (A(t) - A(t_0))^2 \right &gt;
\]</span></p>
<p>In case of self-diffusion coefficient <span class="math inline">\(D_{\mathrm{s}}\)</span> the variable <span class="math inline">\(A\)</span> is the molecular position <span class="math inline">\(\vec{r}_{\mathrm{cm}}\)</span> which in general is the center of mass position of the particles: <span class="math display">\[
\vec{r}_{\mathrm{cm}} = \frac{\sum_{i=1}^{N} m_i \vec{r}_i}{\sum_{i=1}^{N} m_i}
\]</span> where <span class="math inline">\(m_i\)</span> is the atomic mass, <span class="math inline">\(\vec{r}_i\)</span> is the atomic positions and <span class="math inline">\(N\)</span> the number of atoms in the particle.</p>
<p>As well as <span class="math inline">\(\dot{A}\)</span> is the molecular velocity which should be also considered as center of mass.</p>
<section id="einstein-relation" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="einstein-relation">Einstein-Relation</h2>
<p>The Einstein Relation can be therefore written as slope of the mean-squared-displacement (<span class="math inline">\(MSD(\tau)\)</span>) over time origins <span class="math inline">\(\tau\)</span></p>
<p><span class="math display">\[
D_{\mathrm{s}} = \frac{1}{2 \cdot d} \lim _{t\to \infty} \frac{d}{dt} MSD(\tau)
\]</span> where <span class="math inline">\(d=1,2,3\)</span> is the dimensionality.</p>
<section id="mean-squared-displacement" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="mean-squared-displacement">Mean-Squared Displacement</h3>
<p>The mean-squared displacement describes the the temporally displacement of the particle from a time origin <span class="math inline">\(t_0\)</span> averaged over time interval <span class="math inline">\(\tau\)</span> <span class="math display">\[
MSD(\tau) = \left &lt; \frac{1}{N} \sum_{i=1}^{N} |\vec{r} _{i}(t) - \vec{r} _{i}(t_0)|^2  \right &gt;_{\tau}
\]</span> where <span class="math inline">\(N\)</span> is the number of the particle, <span class="math inline">\(\vec{r}_{i}\)</span> is the center-of-mass position vector of the particle <span class="math inline">\(i\)</span>.</p>
<!-- also can be written as running average with window size $\omega$ and gap size $g$
$$
MSD(t) =  \frac{1}{\omega} \sum_{j=1}^{\omega} \frac{1}{L - t \cdot g}  \frac{1}{N} \sum_{i=1}^{N} |\vec{r} _{i}(t+\tau) - \vec{r} _{i}(t)|^2
$$

 -->
<p>If we look at the Figure <a href="#fig-msd" class="quarto-xref">Figure&nbsp;<span>6.3</span></a> (a) we realize the beginning of the MSD is not linear. Only with higher correleation time, normal diffusional (see Figure <a href="#fig-msd" class="quarto-xref">Figure&nbsp;<span>6.3</span></a> (b)) behaviour appear in the linear region.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>How do you get the self-diffusion coefficient out of the MSD regarding the Einstein-relation?</li>
<li>How do you get the gradient/slope of the MSD?</li>
<li>What does the limes in that formular mean?</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The self-diffusion coefficient is the slope of the MSD divided by 2 <span class="math inline">\(\cdot d\)</span>.</p>
<p>But this is only true if correlation time is long enough. We can say that in the linear regime we fulfill this limes due to unchanging slope which represents the difffusion coefficient.</p>
<p>Therefore it is important to have really linear behaviour in order to apply the Einstein relation.</p>
<p>You get the slope by fitting a <a href="../guides/statistics.html">linear regression</a> at the last linear section.</p>
</div>
</div>
</div>
<div id="cell-fig-msd" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> curve_fit</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a>mpl.rcParams[<span class="st">"font.size"</span>] <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>mpl.rcParams[<span class="st">"axes.labelsize"</span>] <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a>data <span class="op">=</span> np.genfromtxt(<span class="st">"../data/diff.out"</span>)</span>
<span id="cb5-10"><a href="#cb5-10"></a>steps <span class="op">=</span> data[:,<span class="dv">0</span>]</span>
<span id="cb5-11"><a href="#cb5-11"></a>time <span class="op">=</span> steps<span class="op">*</span><span class="fl">0.002</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>MSD_x <span class="op">=</span> data[:,<span class="dv">1</span>]</span>
<span id="cb5-13"><a href="#cb5-13"></a>MSD_y <span class="op">=</span> data[:,<span class="dv">2</span>]</span>
<span id="cb5-14"><a href="#cb5-14"></a>MSD_z <span class="op">=</span> data[:,<span class="dv">3</span>]</span>
<span id="cb5-15"><a href="#cb5-15"></a>MSD_xyz <span class="op">=</span> MSD_x <span class="op">+</span> MSD_y <span class="op">+</span> MSD_z</span>
<span id="cb5-16"><a href="#cb5-16"></a></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="kw">def</span> ballistic_regime(x,a):</span>
<span id="cb5-18"><a href="#cb5-18"></a>  <span class="cf">return</span> a<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span></span>
<span id="cb5-19"><a href="#cb5-19"></a></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="kw">def</span> superdiffusion(x,a):</span>
<span id="cb5-21"><a href="#cb5-21"></a>  <span class="cf">return</span> a<span class="op">*</span>x<span class="op">**</span><span class="fl">1.5</span></span>
<span id="cb5-22"><a href="#cb5-22"></a></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="kw">def</span> subdiffusion(x,a):</span>
<span id="cb5-24"><a href="#cb5-24"></a>  <span class="cf">return</span> a<span class="op">*</span>x<span class="op">**</span><span class="fl">0.5</span></span>
<span id="cb5-25"><a href="#cb5-25"></a></span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="kw">def</span> normaldiffusion(x,a):</span>
<span id="cb5-27"><a href="#cb5-27"></a>  <span class="cf">return</span> a<span class="op">*</span>x</span>
<span id="cb5-28"><a href="#cb5-28"></a></span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="kw">def</span> confined_diffusion(x,a,b):</span>
<span id="cb5-30"><a href="#cb5-30"></a>  <span class="cf">return</span> a<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span>b<span class="op">*</span>x))</span>
<span id="cb5-31"><a href="#cb5-31"></a></span>
<span id="cb5-32"><a href="#cb5-32"></a><span class="kw">def</span> linear_regression(x,a,b):</span>
<span id="cb5-33"><a href="#cb5-33"></a>  <span class="cf">return</span> a<span class="op">*</span>x <span class="op">+</span> b</span>
<span id="cb5-34"><a href="#cb5-34"></a></span>
<span id="cb5-35"><a href="#cb5-35"></a>popt, pcov <span class="op">=</span> curve_fit(linear_regression,time[<span class="op">-</span><span class="dv">500</span>:],MSD_xyz[<span class="op">-</span><span class="dv">500</span>:])</span>
<span id="cb5-36"><a href="#cb5-36"></a></span>
<span id="cb5-37"><a href="#cb5-37"></a>d_einstein <span class="op">=</span> popt[<span class="dv">0</span>]<span class="op">/</span><span class="dv">6</span></span>
<span id="cb5-38"><a href="#cb5-38"></a>time_regime<span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">1000</span>)</span>
<span id="cb5-39"><a href="#cb5-39"></a></span>
<span id="cb5-40"><a href="#cb5-40"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>,figsize<span class="op">=</span>(<span class="dv">4</span>,<span class="dv">8</span>),gridspec_kw<span class="op">=</span>{<span class="st">'hspace'</span>: <span class="fl">0.4</span>})</span>
<span id="cb5-41"><a href="#cb5-41"></a>axs[<span class="dv">0</span>].plot(time,MSD_x,label<span class="op">=</span><span class="vs">r"$MSD_x$"</span>,color<span class="op">=</span><span class="st">"C0"</span>)</span>
<span id="cb5-42"><a href="#cb5-42"></a>axs[<span class="dv">0</span>].plot(time,MSD_y,label<span class="op">=</span><span class="vs">r"$MSD_y$"</span>,color<span class="op">=</span><span class="st">"purple"</span>)</span>
<span id="cb5-43"><a href="#cb5-43"></a>axs[<span class="dv">0</span>].plot(time,MSD_z,label<span class="op">=</span><span class="vs">r"$MSD_z$"</span>,color<span class="op">=</span><span class="st">"grey"</span>)</span>
<span id="cb5-44"><a href="#cb5-44"></a>axs[<span class="dv">0</span>].plot(time,MSD_xyz,label<span class="op">=</span><span class="vs">r"$MSD_{x+y+z}$"</span>,color<span class="op">=</span><span class="st">"k"</span>)</span>
<span id="cb5-45"><a href="#cb5-45"></a>axs[<span class="dv">0</span>].vlines(time[<span class="op">-</span><span class="dv">500</span>],<span class="dv">0</span>,<span class="dv">500</span>,color<span class="op">=</span><span class="st">"k"</span>,linestyle<span class="op">=</span><span class="st">"dotted"</span>,label<span class="op">=</span><span class="vs">r"fitting regime"</span>)</span>
<span id="cb5-46"><a href="#cb5-46"></a>axs[<span class="dv">0</span>].plot(time[<span class="op">-</span><span class="dv">500</span>:],linear_regression(time[<span class="op">-</span><span class="dv">500</span>:],<span class="op">*</span>popt),color<span class="op">=</span><span class="st">"red"</span>,linestyle<span class="op">=</span><span class="st">"dashed"</span>,label<span class="op">=</span><span class="vs">r"linear fit $y=a\cdot x + b$: $a= </span><span class="sc">{:.2f}</span><span class="vs">$, $b= </span><span class="sc">{:.2f}</span><span class="vs">$ "</span>.<span class="bu">format</span>(popt[<span class="dv">0</span>],popt[<span class="dv">1</span>]))</span>
<span id="cb5-47"><a href="#cb5-47"></a>axs[<span class="dv">0</span>].text(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1.05</span>, <span class="st">'(a)'</span>, transform<span class="op">=</span>axs[<span class="dv">0</span>].transAxes, fontsize<span class="op">=</span><span class="dv">14</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>)</span>
<span id="cb5-48"><a href="#cb5-48"></a>axs[<span class="dv">0</span>].text(<span class="fl">1.0</span>,<span class="dv">400</span>, <span class="vs">r"$D_s=</span><span class="sc">%2.2f</span><span class="vs">\,\mathrm{\AA^2 ps^{-1</span><span class="sc">}}</span><span class="vs">$"</span> <span class="op">%</span>(d_einstein),fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb5-49"><a href="#cb5-49"></a>axs[<span class="dv">0</span>].legend(fontsize<span class="op">=</span><span class="dv">12</span>,loc<span class="op">=</span><span class="st">'upper left'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="fl">1.05</span>))</span>
<span id="cb5-50"><a href="#cb5-50"></a></span>
<span id="cb5-51"><a href="#cb5-51"></a></span>
<span id="cb5-52"><a href="#cb5-52"></a>axs[<span class="dv">1</span>].plot(time_regime,ballistic_regime(time_regime,<span class="dv">100</span>),label<span class="op">=</span><span class="vs">r"ballistic regime $\propto \tau^2$"</span>, color<span class="op">=</span><span class="st">"gold"</span>, linestyle<span class="op">=</span><span class="st">"dashed"</span>)</span>
<span id="cb5-53"><a href="#cb5-53"></a>axs[<span class="dv">1</span>].plot(time_regime,superdiffusion(time_regime,<span class="dv">100</span>),label<span class="op">=</span><span class="vs">r"superdiffusion regime $\propto \tau^{\alpha}, \alpha&gt;1$"</span>, color<span class="op">=</span><span class="st">"darkred"</span>, linestyle<span class="op">=</span><span class="st">"dashed"</span>)</span>
<span id="cb5-54"><a href="#cb5-54"></a>axs[<span class="dv">1</span>].plot(time_regime,normaldiffusion(time_regime,<span class="dv">100</span>),label<span class="op">=</span><span class="vs">r"normal diffusion regime $\propto \tau$"</span>, color<span class="op">=</span><span class="st">"red"</span>, linestyle<span class="op">=</span><span class="st">"dashed"</span>)</span>
<span id="cb5-55"><a href="#cb5-55"></a>axs[<span class="dv">1</span>].plot(time_regime,subdiffusion(time_regime,<span class="dv">100</span>),label<span class="op">=</span><span class="vs">r"subdiffusion regime $\propto \tau^{\alpha}, \alpha&lt;1$"</span>, color<span class="op">=</span><span class="st">"salmon"</span>, linestyle<span class="op">=</span><span class="st">"dashed"</span>)</span>
<span id="cb5-56"><a href="#cb5-56"></a></span>
<span id="cb5-57"><a href="#cb5-57"></a>axs[<span class="dv">1</span>].plot(time_regime,confined_diffusion(time_regime,<span class="dv">50</span>,<span class="dv">2</span>),label<span class="op">=</span><span class="vs">r"confined diffusion regime $\propto$ const."</span>, color<span class="op">=</span><span class="st">"hotpink"</span>, linestyle<span class="op">=</span><span class="st">"dashed"</span>)</span>
<span id="cb5-58"><a href="#cb5-58"></a></span>
<span id="cb5-59"><a href="#cb5-59"></a></span>
<span id="cb5-60"><a href="#cb5-60"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="vs">r"correlation time $\tau$ in ps"</span>)</span>
<span id="cb5-61"><a href="#cb5-61"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="vs">r"$MSD(t)$ in $\mathrm{\AA^2}$"</span>)</span>
<span id="cb5-62"><a href="#cb5-62"></a></span>
<span id="cb5-63"><a href="#cb5-63"></a>axs[<span class="dv">0</span>].set_ylim(<span class="dv">0</span>,<span class="dv">500</span>)</span>
<span id="cb5-64"><a href="#cb5-64"></a></span>
<span id="cb5-65"><a href="#cb5-65"></a></span>
<span id="cb5-66"><a href="#cb5-66"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="vs">r"correlation time $\tau$ in ps"</span>)</span>
<span id="cb5-67"><a href="#cb5-67"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="vs">r"$MSD(t)$ in $\mathrm{\AA^2}$"</span>)</span>
<span id="cb5-68"><a href="#cb5-68"></a>axs[<span class="dv">1</span>].set_xlim(<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb5-69"><a href="#cb5-69"></a>axs[<span class="dv">1</span>].set_ylim(<span class="dv">0</span>,<span class="dv">500</span>)</span>
<span id="cb5-70"><a href="#cb5-70"></a>axs[<span class="dv">1</span>].text(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1.05</span>, <span class="st">'(b)'</span>, transform<span class="op">=</span>axs[<span class="dv">1</span>].transAxes, fontsize<span class="op">=</span><span class="dv">14</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>)</span>
<span id="cb5-71"><a href="#cb5-71"></a></span>
<span id="cb5-72"><a href="#cb5-72"></a>axs[<span class="dv">1</span>].legend(fontsize<span class="op">=</span><span class="dv">12</span>,loc<span class="op">=</span><span class="st">'upper left'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="fl">1.05</span>))</span>
<span id="cb5-73"><a href="#cb5-73"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-msd" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-msd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="analysis_b_files/figure-html/fig-msd-output-1.png" width="879" height="686" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-msd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.3: (a) MSD(t) plot, (b) diffusion regimes
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="green-kubo-relation" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="green-kubo-relation">Green-Kubo Relation</h2>
<p>The Green-Kubo formalism needs a numerical integration of the velocity-autocorrelation function <span class="math inline">\(VACF(t)\)</span> to get the self-diffusion coefficent <span class="math inline">\(D_{\mathrm{s}}\)</span> <span class="math display">\[
D_{\mathrm{s}} = \frac{1}{d} \int _{0}^{\infty} VACF(t)  dt
\]</span> where <span class="math inline">\(d=1,2,3\)</span> is the dimension.</p>
<section id="veloctiy-autocorrelation-function" class="level3">
<h3 class="anchored" data-anchor-id="veloctiy-autocorrelation-function">Veloctiy-Autocorrelation Function</h3>
<p>The <a href="">Velocity-Autocorrelatin Function</a> <span class="math inline">\(VACF(\tau)\)</span> is averaged over a time interval <span class="math inline">\(\tau\)</span> <span class="math display">\[
VACF(\tau) = \left &lt; \frac{1}{N} \sum_{i=1}^{N} |\vec{v} _{i}(t) \vec{v} _{i}(t_0)|^2 \right &gt;_{\tau}
\]</span> where <span class="math inline">\(\vec{v}_{i}\)</span> is the velocity of the particle <span class="math inline">\(i\)</span> and <span class="math inline">\(t_0\)</span> labels the time origin.</p>
<div id="cell-fig-VACF" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> simpson</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> cumulative_trapezoid</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a>mpl.rcParams[<span class="st">"font.size"</span>] <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>mpl.rcParams[<span class="st">"axes.labelsize"</span>] <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a>data <span class="op">=</span> np.genfromtxt(<span class="st">"../data/green_kubo.out"</span>)</span>
<span id="cb6-11"><a href="#cb6-11"></a>time <span class="op">=</span> data[:,<span class="dv">0</span>]</span>
<span id="cb6-12"><a href="#cb6-12"></a>VACF_x <span class="op">=</span> data[:,<span class="dv">1</span>]</span>
<span id="cb6-13"><a href="#cb6-13"></a>VACF_y <span class="op">=</span> data[:,<span class="dv">2</span>]</span>
<span id="cb6-14"><a href="#cb6-14"></a>VACF_z <span class="op">=</span> data[:,<span class="dv">3</span>]</span>
<span id="cb6-15"><a href="#cb6-15"></a>VACF_xyz <span class="op">=</span> data[:,<span class="dv">4</span>]</span>
<span id="cb6-16"><a href="#cb6-16"></a></span>
<span id="cb6-17"><a href="#cb6-17"></a></span>
<span id="cb6-18"><a href="#cb6-18"></a>integral_VACF_xyz <span class="op">=</span> simpson(VACF_xyz, x<span class="op">=</span>time)</span>
<span id="cb6-19"><a href="#cb6-19"></a>cumulative_integral <span class="op">=</span> cumulative_trapezoid(VACF_xyz, time, initial<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb6-20"><a href="#cb6-20"></a>d_green_kubo <span class="op">=</span> integral_VACF_xyz <span class="op">/</span> <span class="dv">3</span></span>
<span id="cb6-21"><a href="#cb6-21"></a></span>
<span id="cb6-22"><a href="#cb6-22"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>,figsize<span class="op">=</span>(<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb6-23"><a href="#cb6-23"></a>axs.plot(time,VACF_x,label<span class="op">=</span><span class="vs">r"$VACF_x$"</span>,color<span class="op">=</span><span class="st">"C0"</span>)</span>
<span id="cb6-24"><a href="#cb6-24"></a>axs.plot(time,VACF_y,label<span class="op">=</span><span class="vs">r"$VACF_y$"</span>,color<span class="op">=</span><span class="st">"purple"</span>)</span>
<span id="cb6-25"><a href="#cb6-25"></a>axs.plot(time,VACF_z,label<span class="op">=</span><span class="vs">r"$VACF_z$"</span>,color<span class="op">=</span><span class="st">"grey"</span>)</span>
<span id="cb6-26"><a href="#cb6-26"></a>axs.plot(time,VACF_xyz,label<span class="op">=</span><span class="vs">r"$VACF_{x+y+z}$"</span>,color<span class="op">=</span><span class="st">"k"</span>)</span>
<span id="cb6-27"><a href="#cb6-27"></a>axs.plot(time, cumulative_integral, label<span class="op">=</span><span class="vs">r'Cumulative Integral of $VACF_{x+y+z}$'</span>,color<span class="op">=</span><span class="st">"red"</span>)</span>
<span id="cb6-28"><a href="#cb6-28"></a></span>
<span id="cb6-29"><a href="#cb6-29"></a>axs.text(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="vs">r"$D_s = </span><span class="sc">%.2f</span><span class="vs"> \, \mathrm{\AA^2 ps^{-1</span><span class="sc">}}</span><span class="vs">$"</span> <span class="op">%</span>(d_green_kubo), transform<span class="op">=</span>axs.transAxes, fontsize<span class="op">=</span><span class="dv">14</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>)</span>
<span id="cb6-30"><a href="#cb6-30"></a></span>
<span id="cb6-31"><a href="#cb6-31"></a></span>
<span id="cb6-32"><a href="#cb6-32"></a>axs.set_xlabel(<span class="vs">r"correlation time $\tau$ in ps"</span>)</span>
<span id="cb6-33"><a href="#cb6-33"></a>axs.set_ylabel(<span class="vs">r"$VACF(t)$ in $\mathrm{(\AA ps^{-1})^</span><span class="sc">{2}</span><span class="vs">}$"</span>)</span>
<span id="cb6-34"><a href="#cb6-34"></a>axs.legend(fontsize<span class="op">=</span><span class="dv">12</span>,loc<span class="op">=</span><span class="st">'upper left'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="fl">1.05</span>))</span>
<span id="cb6-35"><a href="#cb6-35"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-vacf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-vacf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="analysis_b_files/figure-html/fig-vacf-output-1.png" width="770" height="384" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vacf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.4: VACF(t) plot
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="activation-energy" class="level1 unnumbered">
<h1 class="unnumbered">Activation Energy</h1>
<p>The diffusion coefficient is directly depending on the actiation energy <span class="math inline">\(E_{\mathrm{a}}\)</span> by an exponential decacy <span class="math display">\[
D_{\mathrm{s}}=D_0 e^{-\frac{E_{\mathrm{a}}}{RT}}
\]</span> where <span class="math inline">\(D_0\)</span> is factor of the exponential function, <span class="math inline">\(R=8.314\,\mathrm{JK^{-1}mol^{-1}}\)</span> is the gas constant and <span class="math inline">\(T\)</span> is the respective simulation temperature.</p>
<p>With this formalism we can apply an <a href="https://en.wikipedia.org/wiki/Arrhenius_equation">Arrhenius equation</a> to <a href="../guides/statistics.html">fit a linear function</a> to get the activation energy <span class="math inline">\(E_{\mathrm{a}}\)</span> <span class="math display">\[
\ln (D_{\mathrm{s}}) = -\frac{E_{\mathrm{a}}}{RT} + \ln{D_0}
\]</span></p>
<div id="cell-fig-Ea" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> curve_fit</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a>mpl.rcParams[<span class="st">"font.size"</span>] <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>mpl.rcParams[<span class="st">"axes.labelsize"</span>] <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb7-8"><a href="#cb7-8"></a></span>
<span id="cb7-9"><a href="#cb7-9"></a>diff_4 <span class="op">=</span> np.array([<span class="fl">2.5</span>,<span class="fl">2.7</span>,<span class="fl">2.8</span>,<span class="fl">2.9</span>,<span class="fl">3.2</span>])</span>
<span id="cb7-10"><a href="#cb7-10"></a>diff_8 <span class="op">=</span> np.array([<span class="fl">4.2</span>,<span class="fl">5.8</span>,<span class="fl">4.7</span>,<span class="fl">5.0</span>,<span class="fl">5.3</span>])</span>
<span id="cb7-11"><a href="#cb7-11"></a>diff_12 <span class="op">=</span> np.array([<span class="fl">5.2</span>,<span class="fl">5.8</span>,<span class="fl">5.7</span>,<span class="fl">6.0</span>,<span class="fl">6.3</span>])</span>
<span id="cb7-12"><a href="#cb7-12"></a>diff_16 <span class="op">=</span> np.array([<span class="fl">5.2</span>,<span class="fl">5.9</span>,<span class="fl">6.1</span>,<span class="fl">6.5</span>,<span class="fl">7.0</span>])</span>
<span id="cb7-13"><a href="#cb7-13"></a>temp <span class="op">=</span> np.array([<span class="dv">300</span>,<span class="dv">323</span>,<span class="dv">348</span>,<span class="dv">373</span>,<span class="dv">398</span>])</span>
<span id="cb7-14"><a href="#cb7-14"></a>diff_300 <span class="op">=</span> np.array([<span class="fl">2.5</span>,<span class="fl">4.2</span>,<span class="fl">5.2</span>,<span class="fl">5.2</span>]) </span>
<span id="cb7-15"><a href="#cb7-15"></a>diff_323 <span class="op">=</span> np.array([<span class="fl">2.7</span>,<span class="fl">5.8</span>,<span class="fl">5.8</span>,<span class="fl">5.9</span>]) </span>
<span id="cb7-16"><a href="#cb7-16"></a>diff_348 <span class="op">=</span> np.array([<span class="fl">2.8</span>,<span class="fl">4.7</span>,<span class="fl">5.7</span>,<span class="fl">6.1</span>]) </span>
<span id="cb7-17"><a href="#cb7-17"></a>diff_373 <span class="op">=</span> np.array([<span class="fl">2.9</span>,<span class="fl">5.0</span>,<span class="fl">6.0</span>,<span class="fl">6.5</span>]) </span>
<span id="cb7-18"><a href="#cb7-18"></a>diff_398 <span class="op">=</span> np.array([<span class="fl">3.2</span>,<span class="fl">5.3</span>,<span class="fl">6.3</span>,<span class="fl">7.0</span>]) </span>
<span id="cb7-19"><a href="#cb7-19"></a>loading <span class="op">=</span> np.array([<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">12</span>,<span class="dv">16</span>])</span>
<span id="cb7-20"><a href="#cb7-20"></a></span>
<span id="cb7-21"><a href="#cb7-21"></a></span>
<span id="cb7-22"><a href="#cb7-22"></a></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="kw">def</span> linear_regression(x,a,b):</span>
<span id="cb7-24"><a href="#cb7-24"></a>  <span class="cf">return</span> a<span class="op">*</span>x <span class="op">+</span> b</span>
<span id="cb7-25"><a href="#cb7-25"></a></span>
<span id="cb7-26"><a href="#cb7-26"></a>popt_4, pcov_4 <span class="op">=</span> curve_fit(linear_regression,np.log(diff_4),<span class="dv">1000</span><span class="op">/</span>temp)</span>
<span id="cb7-27"><a href="#cb7-27"></a>popt_8, pcov_8 <span class="op">=</span> curve_fit(linear_regression,np.log(diff_8),<span class="dv">1000</span><span class="op">/</span>temp)</span>
<span id="cb7-28"><a href="#cb7-28"></a>popt_12, pcov_12 <span class="op">=</span> curve_fit(linear_regression,np.log(diff_12),<span class="dv">1000</span><span class="op">/</span>temp)</span>
<span id="cb7-29"><a href="#cb7-29"></a>popt_16, pcov_16 <span class="op">=</span> curve_fit(linear_regression,np.log(diff_16),<span class="dv">1000</span><span class="op">/</span>temp)</span>
<span id="cb7-30"><a href="#cb7-30"></a></span>
<span id="cb7-31"><a href="#cb7-31"></a></span>
<span id="cb7-32"><a href="#cb7-32"></a>R<span class="op">=</span><span class="fl">8.313</span></span>
<span id="cb7-33"><a href="#cb7-33"></a>Ea_4 <span class="op">=</span> popt_4[<span class="dv">0</span>]<span class="op">*</span>R</span>
<span id="cb7-34"><a href="#cb7-34"></a>Ea_8 <span class="op">=</span> popt_8[<span class="dv">0</span>]<span class="op">*</span>R</span>
<span id="cb7-35"><a href="#cb7-35"></a>Ea_12 <span class="op">=</span> popt_12[<span class="dv">0</span>]<span class="op">*</span>R</span>
<span id="cb7-36"><a href="#cb7-36"></a>Ea_16 <span class="op">=</span> popt_16[<span class="dv">0</span>]<span class="op">*</span>R</span>
<span id="cb7-37"><a href="#cb7-37"></a></span>
<span id="cb7-38"><a href="#cb7-38"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">8</span>),gridspec_kw<span class="op">=</span>{<span class="st">'hspace'</span>: <span class="fl">0.4</span>,<span class="st">'wspace'</span>: <span class="fl">0.4</span>})</span>
<span id="cb7-39"><a href="#cb7-39"></a>axs[<span class="dv">0</span>,<span class="dv">0</span>].scatter(temp,diff_4,label<span class="op">=</span><span class="vs">r"$n=4$"</span>)</span>
<span id="cb7-40"><a href="#cb7-40"></a>axs[<span class="dv">0</span>,<span class="dv">0</span>].scatter(temp,diff_8,label<span class="op">=</span><span class="vs">r"$n=8$"</span>)</span>
<span id="cb7-41"><a href="#cb7-41"></a>axs[<span class="dv">0</span>,<span class="dv">0</span>].scatter(temp,diff_12,label<span class="op">=</span><span class="vs">r"$n=12$"</span>)</span>
<span id="cb7-42"><a href="#cb7-42"></a>axs[<span class="dv">0</span>,<span class="dv">0</span>].scatter(temp,diff_16,label<span class="op">=</span><span class="vs">r"$n=16$"</span>)</span>
<span id="cb7-43"><a href="#cb7-43"></a>axs[<span class="dv">0</span>,<span class="dv">0</span>].set_xlabel(<span class="vs">r"$T$ in K"</span>)</span>
<span id="cb7-44"><a href="#cb7-44"></a>axs[<span class="dv">0</span>,<span class="dv">0</span>].set_ylabel(<span class="vs">r"$D_{\mathrm</span><span class="sc">{s}</span><span class="vs">}$ in $10^{-8}ms^{-1}$"</span>)</span>
<span id="cb7-45"><a href="#cb7-45"></a>axs[<span class="dv">0</span>,<span class="dv">0</span>].legend(fontsize<span class="op">=</span><span class="dv">8</span>,loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb7-46"><a href="#cb7-46"></a></span>
<span id="cb7-47"><a href="#cb7-47"></a></span>
<span id="cb7-48"><a href="#cb7-48"></a>axs[<span class="dv">0</span>,<span class="dv">1</span>].scatter(loading,diff_300,label<span class="op">=</span><span class="vs">r"$T=300\,{\mathrm</span><span class="sc">{K}</span><span class="vs">}$"</span>)</span>
<span id="cb7-49"><a href="#cb7-49"></a>axs[<span class="dv">0</span>,<span class="dv">1</span>].scatter(loading,diff_323,label<span class="op">=</span><span class="vs">r"$T=323\,{\mathrm</span><span class="sc">{K}</span><span class="vs">}$"</span>)</span>
<span id="cb7-50"><a href="#cb7-50"></a>axs[<span class="dv">0</span>,<span class="dv">1</span>].scatter(loading,diff_348,label<span class="op">=</span><span class="vs">r"$T=348\,{\mathrm</span><span class="sc">{K}</span><span class="vs">}$"</span>)</span>
<span id="cb7-51"><a href="#cb7-51"></a>axs[<span class="dv">0</span>,<span class="dv">1</span>].scatter(loading,diff_373,label<span class="op">=</span><span class="vs">r"$T=373\,{\mathrm</span><span class="sc">{K}</span><span class="vs">}$"</span>)</span>
<span id="cb7-52"><a href="#cb7-52"></a>axs[<span class="dv">0</span>,<span class="dv">1</span>].scatter(loading,diff_398,label<span class="op">=</span><span class="vs">r"$T=398\,{\mathrm</span><span class="sc">{K}</span><span class="vs">}$"</span>)</span>
<span id="cb7-53"><a href="#cb7-53"></a>axs[<span class="dv">0</span>,<span class="dv">1</span>].set_xlabel(<span class="vs">r"$n$"</span>)</span>
<span id="cb7-54"><a href="#cb7-54"></a>axs[<span class="dv">0</span>,<span class="dv">1</span>].set_ylabel(<span class="vs">r"$D_{\mathrm</span><span class="sc">{s}</span><span class="vs">}$ in $10^{-8}ms^{-1}$"</span>)</span>
<span id="cb7-55"><a href="#cb7-55"></a>axs[<span class="dv">0</span>,<span class="dv">1</span>].legend(fontsize<span class="op">=</span><span class="dv">8</span>,loc<span class="op">=</span><span class="st">'lower right'</span>)</span>
<span id="cb7-56"><a href="#cb7-56"></a></span>
<span id="cb7-57"><a href="#cb7-57"></a>axs[<span class="dv">1</span>,<span class="dv">0</span>].scatter(<span class="dv">1000</span><span class="op">/</span>temp,np.log(diff_4),label<span class="op">=</span><span class="vs">r"$n=4$"</span>)</span>
<span id="cb7-58"><a href="#cb7-58"></a>axs[<span class="dv">1</span>,<span class="dv">0</span>].scatter(<span class="dv">1000</span><span class="op">/</span>temp,np.log(diff_8),label<span class="op">=</span><span class="vs">r"$n=8$"</span>)</span>
<span id="cb7-59"><a href="#cb7-59"></a>axs[<span class="dv">1</span>,<span class="dv">0</span>].scatter(<span class="dv">1000</span><span class="op">/</span>temp,np.log(diff_12),label<span class="op">=</span><span class="vs">r"$n=12$"</span>)</span>
<span id="cb7-60"><a href="#cb7-60"></a>axs[<span class="dv">1</span>,<span class="dv">0</span>].scatter(<span class="dv">1000</span><span class="op">/</span>temp,np.log(diff_16),label<span class="op">=</span><span class="vs">r"$n=16$"</span>)</span>
<span id="cb7-61"><a href="#cb7-61"></a>axs[<span class="dv">1</span>,<span class="dv">0</span>].set_xlabel(<span class="vs">r"$1000/T$ in K$^{-1}$"</span>)</span>
<span id="cb7-62"><a href="#cb7-62"></a>axs[<span class="dv">1</span>,<span class="dv">0</span>].set_ylabel(<span class="vs">r"$\mathrm</span><span class="sc">{ln}</span><span class="vs">(D_{\mathrm</span><span class="sc">{s}</span><span class="vs">})$"</span>)</span>
<span id="cb7-63"><a href="#cb7-63"></a>axs[<span class="dv">1</span>,<span class="dv">0</span>].legend(fontsize<span class="op">=</span><span class="dv">8</span>,loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb7-64"><a href="#cb7-64"></a></span>
<span id="cb7-65"><a href="#cb7-65"></a>axs[<span class="dv">1</span>,<span class="dv">1</span>].scatter(<span class="dv">4</span>,Ea_4)</span>
<span id="cb7-66"><a href="#cb7-66"></a>axs[<span class="dv">1</span>,<span class="dv">1</span>].scatter(<span class="dv">8</span>,Ea_8)</span>
<span id="cb7-67"><a href="#cb7-67"></a>axs[<span class="dv">1</span>,<span class="dv">1</span>].scatter(<span class="dv">12</span>,Ea_12)</span>
<span id="cb7-68"><a href="#cb7-68"></a>axs[<span class="dv">1</span>,<span class="dv">1</span>].scatter(<span class="dv">16</span>,Ea_16)</span>
<span id="cb7-69"><a href="#cb7-69"></a>axs[<span class="dv">1</span>,<span class="dv">1</span>].set_ylabel(<span class="vs">r"$E_{\mathrm</span><span class="sc">{a}</span><span class="vs">}$ in kcal mol$^{-1}$"</span>)</span>
<span id="cb7-70"><a href="#cb7-70"></a>axs[<span class="dv">1</span>,<span class="dv">1</span>].set_xlabel(<span class="vs">r"$n$"</span>)</span>
<span id="cb7-71"><a href="#cb7-71"></a>axs[<span class="dv">1</span>,<span class="dv">1</span>].legend(fontsize<span class="op">=</span><span class="dv">8</span>,loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb7-72"><a href="#cb7-72"></a></span>
<span id="cb7-73"><a href="#cb7-73"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-ea" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="analysis_b_files/figure-html/fig-ea-output-1.png" width="688" height="674" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.5: (a) D(T), (b) D(n), (c) ln(D(1000/T) and (d) Ea(n))
</figcaption>
</figure>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-Kubo1957" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">Kubo, R. Statistical-Mechanical Theory of Irreversible Processes. I. General Theory and Simple Applications to Magnetic and Conduction Problems. <em>Journal of the Physical Society of Japan</em> <strong>1957</strong>, <em>12</em> [6], 570–586. <a href="https://doi.org/10.1143/jpsj.12.570">https://doi.org/10.1143/jpsj.12.570</a>.</div>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../exercise_b/exercise_b.html" class="pagination-link" aria-label="Background Info B">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Background Info B</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../exercise_b/howto_b.html" class="pagination-link" aria-label="HowTo B">
        <span class="nav-page-text"><span class="chapter-title">HowTo B</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>